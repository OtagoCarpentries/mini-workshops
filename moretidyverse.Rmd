---
title: "More Tidyverse"
description: |
  Take the time to explore the lesser known functions and packages of the Tidyverse
author:
  - name: Murray Cadzow
    url: 
    affiliation: University of Otago
    affiliation_url:
  - name: Matt Bixley
    url: 
    affiliation: NeSI
    affiliation_url:
date: "`r Sys.Date()`"
output: 
  distill::distill_article:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

Description: Take the time to explore the lesser known functions and packages of the Tidyverse. Learn about how to access googlesheets, use times/dates, manipulate text, use functional programming to replace loops, and more.

Learning objectives

- What packages are in the tidyverse
- Understand functional programming







> The tidyverse is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures. 
> -  https://www.tidyverse.org


## Core Tidyverse

```{r, message = TRUE}
library(tidyverse)
```



### tibble

```{r, echo = FALSE}
knitr::include_graphics("images/tibble.png")
```


`tibble::tribble` is a useful function if you want to manually input a small amount of data.

```{r, echo = TRUE}
tibble::tribble( ~column1, ~column2, ~column3,
                 "a", 1, TRUE,
                 "b", 2, FALSE)
```



`tibble::glimpse` is similar to `str` but can be embedded in pipelines as it invisibly returns the original data.

```{r}
tibble::glimpse(mtcars)
```


### [ggplot2](https://ggplot2.tidyverse.org)

```{r, echo = FALSE}
knitr::include_graphics("images/ggplot2.png")
```

The majority of `ggplot2` functions are specific to the type of visualisation that is being created and well covered by the cheatsheet. There are two however that can be very helpful to know about.


`ggplot2::theme_set` allows you to apply a theme to all of your ggplots. It would usually be called near the start of a script.


`ggplot2::ggplot_build` is the function that allows you pull out the data that is being used to create a plot. Each component of a ggplot is stored as an element of a list and 

```{r plot_example}
p <- ggplot(data = mtcars, aes(x = hp, y = mpg)) + geom_point() + geom_smooth(method = 'lm')

plot(p)
```

```{r}
names(ggplot2::ggplot_build(p))

ggplot2::ggplot_build(p)[["data"]] %>% tibble::glimpse()
```

### [dplyr](https://dplyr.tidyverse.org)


```{r, echo = FALSE}
knitr::include_graphics("images/dplyr.png")
```
 
- `dplyr::transmute`
- `dplyr::relocate`
- `dplyr::across`
- `dplyr::starts_with`/`dplyr::contains`/`dplyr::ends_with`
- `dplyr::case_when`

### [tidyr](https://tidyr.tidyverse.org)


```{r, echo = FALSE}
knitr::include_graphics("images/tidyr.png")
```

- `tidyr::nest`
- `tidyr::unnest`
- `tidyr::separate`/`tidyr::separate_rows`
- `tidyr::unite`
- `tidyr::crossing`
- `tidyr::drop_na`
- `tidyr::replace_na`

### forcats


```{r, echo = FALSE}
knitr::include_graphics("images/forcats.png")
```

-`forcats::relevel`
- `forcats::reorder`
- `forcats::recode`

### stringr


```{r, echo = FALSE}
knitr::include_graphics("images/stringr.png")
```
- `stringr::str_remove`
- `stringr::extract`

### readr


```{r, echo = FALSE}
knitr::include_graphics("images/readr.png")
```

- `readr::read_csv_chunked`

`readr::parse_number` is an extremely useful function to know about if you are reading data into R that you know is numerical in nature but might contain extra characters such as units.

```{r}
text_to_parse <- c(" 0.4m", "-6", "a5", "1E-2", "24%", "3e2")

readr::parse_number(text_to_parse)
```


### purrr


```{r, echo = FALSE}
knitr::include_graphics("images/purrr.png")
```

- `purrr::map`
- `purrr::walk`
- `purrr::transpose`
- `purrr::keep`/`purrr::discard`/`purrr::pluck`





## Extra Tidyverse

- readxl
- googlesheets4
- lubridate
    - `lubridate::ymd`
- hms
- magrittr
    - `magrittr::%$%`
    - `magrittr::%T%`
- glue
    - `glue::glue`
- dtplyr
- dbplyr


